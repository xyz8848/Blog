{"title":"如何使用 GitHub Action 自动部署 Hexo 博客","slug":"11","date":"2022-04-04T18:32:32.000Z","updated":"2024-07-02T13:13:11.243Z","comments":true,"path":"api/articles/11.json","excerpt":null,"covers":null,"content":"<h2 id=\"Step-1\"><a href=\"#Step-1\" class=\"headerlink\" title=\"Step 1\"></a>Step 1</h2><p>把 Hexo 代码放到 GitHub 的仓库里</p>\n<h2 id=\"Step-2\"><a href=\"#Step-2\" class=\"headerlink\" title=\"Step 2\"></a>Step 2</h2><p>在 <code>.github/workflows</code> 中创建一个 <code>deploy.yml</code> 文件</p>\n<h2 id=\"Step-3\"><a href=\"#Step-3\" class=\"headerlink\" title=\"Step 3\"></a>Step 3</h2><p>在刚刚创建的文件中输入以下代码</p>\n<figure class=\"highlight yml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># @author: xyz8848</span></span><br><span class=\"line\"><span class=\"comment\"># @see https://xyz8848.com/index.php/archives/11/</span></span><br><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Hexo</span> <span class=\"string\">Blog</span> <span class=\"string\">Delopy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">build:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span> </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">    <span class=\"comment\"># @see https://github.com/actions/checkout</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Checkout</span> <span class=\"string\">Repository</span> <span class=\"string\">master</span> <span class=\"string\">branch</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@master</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># @see https://github.com/actions/setup-node</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Node.js</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-node@master</span></span><br><span class=\"line\">      <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"attr\">node-version:</span> <span class=\"string\">\"14\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Hexo</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        npm install hexo-cli -g</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span> <span class=\"string\">Hexo</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        hexo clean</span></span><br><span class=\"line\"><span class=\"string\">        hexo generate</span></span><br><span class=\"line\"><span class=\"string\">        hexo deploy</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Git</span> <span class=\"string\">Infomation</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        git config --global user.name '&lt;你的GitHub用户名&gt;'</span></span><br><span class=\"line\"><span class=\"string\">        git config --global user.email '&lt;你的GitHub邮箱&gt;'</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span> <span class=\"string\">to</span> <span class=\"string\">GitHub</span> <span class=\"string\">Pages</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">crazy-max/ghaction-github-pages@v2</span></span><br><span class=\"line\">      <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"comment\"># 部署到 gh-pages 分支</span></span><br><span class=\"line\">        <span class=\"attr\">target_branch:</span> <span class=\"string\">gh-pages</span></span><br><span class=\"line\">        <span class=\"comment\"># 部署目录为 Hexo 的默认输出目录</span></span><br><span class=\"line\">        <span class=\"attr\">build_dir:</span> <span class=\"string\">public</span></span><br><span class=\"line\">        <span class=\"comment\"># 自定义域名(CNAME)(可选)</span></span><br><span class=\"line\">        <span class=\"attr\">fqdn:</span> </span><br><span class=\"line\">        <span class=\"comment\"># 强制提交</span></span><br><span class=\"line\">        <span class=\"attr\">keep_history:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">      <span class=\"attr\">env:</span></span><br><span class=\"line\">        <span class=\"comment\"># @see https://docs.github.com/cn/actions/reference/authentication-in-a-workflow#about-the-github_token-secret</span></span><br><span class=\"line\">        <span class=\"attr\">GITHUB_TOKEN:</span> <span class=\"string\">${{</span> <span class=\"string\">secrets.GITHUB_TOKEN</span> <span class=\"string\">}}</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h2 id=\"Step-4\"><a href=\"#Step-4\" class=\"headerlink\" title=\"Step 4\"></a>Step 4</h2><p>更改 <code>deploy.yml</code> 中的两个字段：</p>\n<ul>\n<li>&lt;你的GitHub用户名&gt;</li>\n<li>&lt;你的GitHub邮箱&gt;</li>\n</ul>\n<script src=\"https://giscus.app/client.js\" data-repo=\"XyzComments/blog.xyz8848.com\" data-repo-id=\"R_kgDOHq8Hag\" data-category=\"Comments\" data-category-id=\"DIC_kwDOHq8Has4CQRHf\" data-mapping=\"pathname\" data-reactions-enabled=\"1\" data-emit-metadata=\"0\" data-input-position=\"top\" data-theme=\"light\" data-lang=\"zh-CN\" crossorigin=\"anonymous\" async=\"\">\n</script>\n","more":"<h2 id=\"Step-1\"><a href=\"#Step-1\" class=\"headerlink\" title=\"Step 1\"></a>Step 1</h2><p>把 Hexo 代码放到 GitHub 的仓库里</p>\n<h2 id=\"Step-2\"><a href=\"#Step-2\" class=\"headerlink\" title=\"Step 2\"></a>Step 2</h2><p>在 <code>.github/workflows</code> 中创建一个 <code>deploy.yml</code> 文件</p>\n<h2 id=\"Step-3\"><a href=\"#Step-3\" class=\"headerlink\" title=\"Step 3\"></a>Step 3</h2><p>在刚刚创建的文件中输入以下代码</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># @author: xyz8848</span></span><br><span class=\"line\"><span class=\"comment\"># @see https://xyz8848.com/index.php/archives/11/</span></span><br><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Hexo</span> <span class=\"string\">Blog</span> <span class=\"string\">Delopy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">master</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">build:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span> </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">    <span class=\"comment\"># @see https://github.com/actions/checkout</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Checkout</span> <span class=\"string\">Repository</span> <span class=\"string\">master</span> <span class=\"string\">branch</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@master</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># @see https://github.com/actions/setup-node</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Node.js</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-node@master</span></span><br><span class=\"line\">      <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"attr\">node-version:</span> <span class=\"string\">&quot;14&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Hexo</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        npm install hexo-cli -g</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span> <span class=\"string\">Hexo</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        hexo clean</span></span><br><span class=\"line\"><span class=\"string\">        hexo generate</span></span><br><span class=\"line\"><span class=\"string\">        hexo deploy</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Git</span> <span class=\"string\">Infomation</span></span><br><span class=\"line\">      <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        git config --global user.name &#x27;&lt;你的GitHub用户名&gt;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        git config --global user.email &#x27;&lt;你的GitHub邮箱&gt;&#x27;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span> <span class=\"string\">to</span> <span class=\"string\">GitHub</span> <span class=\"string\">Pages</span></span><br><span class=\"line\">      <span class=\"attr\">uses:</span> <span class=\"string\">crazy-max/ghaction-github-pages@v2</span></span><br><span class=\"line\">      <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"comment\"># 部署到 gh-pages 分支</span></span><br><span class=\"line\">        <span class=\"attr\">target_branch:</span> <span class=\"string\">gh-pages</span></span><br><span class=\"line\">        <span class=\"comment\"># 部署目录为 Hexo 的默认输出目录</span></span><br><span class=\"line\">        <span class=\"attr\">build_dir:</span> <span class=\"string\">public</span></span><br><span class=\"line\">        <span class=\"comment\"># 自定义域名(CNAME)(可选)</span></span><br><span class=\"line\">        <span class=\"attr\">fqdn:</span> </span><br><span class=\"line\">        <span class=\"comment\"># 强制提交</span></span><br><span class=\"line\">        <span class=\"attr\">keep_history:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">      <span class=\"attr\">env:</span></span><br><span class=\"line\">        <span class=\"comment\"># @see https://docs.github.com/cn/actions/reference/authentication-in-a-workflow#about-the-github_token-secret</span></span><br><span class=\"line\">        <span class=\"attr\">GITHUB_TOKEN:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.GITHUB_TOKEN</span> <span class=\"string\">&#125;&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Step-4\"><a href=\"#Step-4\" class=\"headerlink\" title=\"Step 4\"></a>Step 4</h2><p>更改 <code>deploy.yml</code> 中的两个字段：</p>\n<ul>\n<li>&lt;你的GitHub用户名&gt;</li>\n<li>&lt;你的GitHub邮箱&gt;</li>\n</ul>\n<script src=\"https://giscus.app/client.js\"\n        data-repo=\"XyzComments/blog.xyz8848.com\"\n        data-repo-id=\"R_kgDOHq8Hag\"\n        data-category=\"Comments\"\n        data-category-id=\"DIC_kwDOHq8Has4CQRHf\"\n        data-mapping=\"pathname\"\n        data-reactions-enabled=\"1\"\n        data-emit-metadata=\"0\"\n        data-input-position=\"top\"\n        data-theme=\"light\"\n        data-lang=\"zh-CN\"\n        crossorigin=\"anonymous\"\n        async>\n</script>\n","categories":[{"name":"Hexo","path":"api/categories/Hexo.json"}],"tags":[{"name":"GitHub","path":"api/tags/GitHub.json"},{"name":"GitHub Action","path":"api/tags/GitHub Action.json"},{"name":"Hexo","path":"api/tags/Hexo.json"},{"name":"CI/CD","path":"api/tags/CI/CD.json"},{"name":"自动化","path":"api/tags/自动化.json"}]}